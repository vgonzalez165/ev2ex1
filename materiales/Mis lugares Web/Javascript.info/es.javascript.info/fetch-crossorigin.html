<!DOCTYPE html><html lang="es" data-theme-enabled="1">
<!-- Mirrored from es.javascript.info/fetch-crossorigin by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 07 Feb 2023 21:14:42 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head><script>window.currentUser = null;</script><script>window.shopCurrency = "EUR";</script><script>window.localCurrency = "EUR";</script><script>window.countryCode = "us";</script><script>window.rateShopTo = {"EUR":1,"USD":1.0766800785115114,"AMD":432.27119525485557};</script><title itemprop="name">Fetch: Cross-Origin Requests</title><link href="pack/styles.40bd864cfdb7b5d1a94b.css" rel="stylesheet"><meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=yes, minimum-scale=1.0"><meta name="apple-mobile-web-app-capable" content="yes"><!-- chrome autotranslate is enabled only for "en" main version--><meta name="google" content="notranslate"><script>if (window.devicePixelRatio > 1) document.cookie = 'pixelRatio=' + window.devicePixelRatio + ';path=/;expires=Tue, 19 Jan 2038 03:14:07 GMT';</script><link href="http://fonts.googleapis.com/css?family=Open+Sans:bold,italic,bolditalic" rel="stylesheet"><link rel="apple-touch-icon-precomposed" href="img/favicon/apple-touch-icon-precomposed.png"><link rel="canonical" href="fetch-crossorigin.html"><meta name="msapplication-TileColor" content="#222A2C"><meta name="msapplication-TileImage" content="/img/favicon/tileicon.png"><link rel="icon" href="img/favicon/favicon.png"><meta itemprop="image" content="https://es.javascript.info/img/site_preview_en_512x512.png"><meta property="og:title" content="Fetch: Cross-Origin Requests"><meta property="og:image" content="https://es.javascript.info/img/site_preview_en_1200x630.png"><meta property="og:image:type" content="image/png"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="630"><meta property="fb:admins" content="100001562528165"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="Fetch: Cross-Origin Requests"><meta name="twitter:site" content="@iliakan"><meta name="twitter:creator" content="@iliakan"><meta name="twitter:image" content="https://es.javascript.info/img/site_preview_en_512x512.png"><link rel="prev" href="fetch-abort.html"><link rel="next" href="fetch-api.html"><script>window.GA_ID = "UA-2056213-15";</script><script>window.YANDEX_METRIKA_ID = 32184394;</script><script>window.GoogleAnalyticsObject="ga",window.ga=function(){window.ga.q.push(arguments)},window.ga.q=[],window.ga.l=Date.now(),ga("create",GA_ID,"auto"),window.GTM_ID&&ga("require",GTM_ID),window.currentUser?ga("set","&uid",currentUser.id):ga("set","anonymizeIp",!0),window.addEventListener("error",function(e){var r=(e.filename||e.errorUrl)+": "+(e.lineno||e.errorLine),n=e.stack||e.error&&e.error.stack;ga("send","exception",{exDescription:e.message+" "+r+" "+n,exFatal:!0})});</script><script src="../www.google-analytics.com/analytics.js" async></script><script>ga('send', 'pageview');</script><script>window.metrika={reachGoal:function(){}},window.yandex_metrika_callbacks=[function(){try{window.metrika=new Ya.Metrika({id:YANDEX_METRIKA_ID,webvisor:!0,clickmap:!0,params:{user:window.currentUser&&window.currentUser.id}}),metrika.trackLinks({delay:150}),window.addEventListener("error",function(r){window.metrika.reachGoal("JSERROR",{src:(r.filename||r.errorUrl)+": "+(r.lineno||r.errorLine),stack:r.stack||r.error&&r.error.stack,message:r.message})})}catch(r){}}];</script><script src="../mc.yandex.ru/metrika/watch.js" async></script><script>window.RECAPTCHA_ID = "6LfmLAEVAAAAAJMykMnf7aY8nkyTRmYi2ynx51R1";</script><script src="pack/init.da0cbf9711553523e21d.js"></script><script src="pack/head.d82dc89d7b800e91179f.js" defer></script><meta property="og:title" content="Fetch: Cross-Origin Requests"><meta property="og:type" content="article"><script src="pack/tutorial.7967275b5846db2d02db.js" defer></script><script src="pack/footer.378d5659c5f335e3ee99.js" defer></script></head><body class="no-icons"><script>window.fontTest();</script><div class="page-wrapper page-wrapper_sidebar_on"><!--[if IE]><div style="color:red;text-align:center">Lo sentimos, Internet Explorer no es compatible. Utilice un navegador más nuevo.</div><![endif]--><div class="sitetoolbar sitetoolbar_tutorial"><script>window.langs = [{"code":"ar","name":"Arabic"},{"code":"az","name":"Azerbaijani"},{"code":"bg","name":"Bulgarian"},{"code":"bn","name":"Bengali"},{"code":"bs","name":"Bosnian"},{"code":"ca","name":"Catalan"},{"code":"cs","name":"Czech"},{"code":"da","name":"Danish"},{"code":"de","name":"German"},{"code":"el","name":"Greek"},{"code":"en","name":"English"},{"code":"es","name":"Spanish"},{"code":"fa","name":"Persian (Farsi)"},{"code":"fi","name":"Finnish"},{"code":"fr","name":"French"},{"code":"he","name":"Hebrew"},{"code":"hi","name":"Hindi"},{"code":"hr","name":"Croatian"},{"code":"hu","name":"Hungarian"},{"code":"hy","name":"Armenian"},{"code":"id","name":"Indonesian"},{"code":"it","name":"Italian"},{"code":"ja","name":"Japanese"},{"code":"ka","name":"Georgian"},{"code":"kk","name":"Kazakh"},{"code":"km","name":"Central Khmer"},{"code":"ko","name":"Korean"},{"code":"ky","name":"Kyrgyz"},{"code":"lt","name":"Lithuanian"},{"code":"me","name":"Montenegrin"},{"code":"ml","name":"Malayalam"},{"code":"ms","name":"Malay"},{"code":"my","name":"Burmese"},{"code":"nl","name":"Dutch"},{"code":"no","name":"Norvegian"},{"code":"pa","name":"Punjabi"},{"code":"pl","name":"Polish"},{"code":"pt","name":"Portuguese"},{"code":"ro","name":"Romanian"},{"code":"ru","name":"Russian"},{"code":"si","name":"Sinhala"},{"code":"sk","name":"Slovak"},{"code":"sl","name":"Slovenian"},{"code":"sq","name":"Albanian"},{"code":"sr","name":"Serbian"},{"code":"ta","name":"Tamil"},{"code":"te","name":"Telugu"},{"code":"test","name":"Test"},{"code":"th","name":"Thai"},{"code":"tk","name":"Turkmen"},{"code":"tr","name":"Turkish"},{"code":"uk","name":"Ukrainian"},{"code":"ur","name":"Urdu"},{"code":"uz","name":"Uzbek"},{"code":"v2","name":"v2"},{"code":"vi","name":"Vietnamese"},{"code":"zh-hant","name":"Chinese Traditional"},{"code":"zh","name":"Chinese"}];</script><script>window.lang = "es";</script><script>{let t=navigator.languages||[];t=t.map(t=>t.toLowerCase());let o,i,n=[];for(let o of window.langs)for(let i of t)if(i===o.code||i.startsWith(o.code+"-")){n.push(o);break}if(!o&&"ru"!=lang&&"en"!=lang){n.find(t=>"en"==t.code)&&(o=`\n            According to your browser headers, you know English. Please help to <a href="https://github.com/javascript-tutorial/${lang}.javascript.info#readme">translate the tutorial</a>.\n            Thank you!\n          `,i="notify-translate-tutorial-local")}if(o){let t=`<div class="notification notification_top notification_info sitetoolbar__notification" style="display:none" id="${i}">\n          <div class="notification__content">${o}</div>\n          <button class="notification__close" title="Close"></button>\n        </div>`;document.write(t),showTopNotification()}}</script><div class="sitetoolbar__content"><div class="sitetoolbar__lang-switcher"><button class="sitetoolbar__dropdown-button" data-dropdown-toggler>ES</button><div class="sitetoolbar__dropdown-wrap"><div class="sitetoolbar__dropdown-body"><div class="sitetoolbar__lang-switcher-body"><div class="supported-langs supported-langs_toolbar"><div class="supported-langs__container"><ul class="supported-langs__list" style="height:200px"><li class="supported-langs__item"><a class="supported-langs__link" href="https://ar.javascript.info/"><span class="supported-langs__brief">AR</span><span class="supported-langs__title">عربي</span></a></li><li class="supported-langs__item"><a class="supported-langs__link" href="https://javascript.info/fetch-crossorigin"><span class="supported-langs__brief">EN</span><span class="supported-langs__title">English</span></a></li><li class="supported-langs__item supported-langs__item_current"><a class="supported-langs__link" href="fetch-crossorigin.html"><span class="supported-langs__brief">ES</span><span class="supported-langs__title">Español</span></a></li><li class="supported-langs__item"><a class="supported-langs__link" href="https://fa.javascript.info/"><span class="supported-langs__brief">FA</span><span class="supported-langs__title">فارسی</span></a></li><li class="supported-langs__item"><a class="supported-langs__link" href="https://fr.javascript.info/fetch-crossorigin"><span class="supported-langs__brief">FR</span><span class="supported-langs__title">Français</span></a></li><li class="supported-langs__item"><a class="supported-langs__link" href="https://id.javascript.info/fetch-crossorigin"><span class="supported-langs__brief">ID</span><span class="supported-langs__title">Indonesia</span></a></li></ul><ul class="supported-langs__list" style="height:200px"><li class="supported-langs__item"><a class="supported-langs__link" href="https://it.javascript.info/fetch-crossorigin"><span class="supported-langs__brief">IT</span><span class="supported-langs__title">Italiano</span></a></li><li class="supported-langs__item"><a class="supported-langs__link" href="https://ja.javascript.info/fetch-crossorigin"><span class="supported-langs__brief">JA</span><span class="supported-langs__title">日本語</span></a></li><li class="supported-langs__item"><a class="supported-langs__link" href="https://ko.javascript.info/fetch-crossorigin"><span class="supported-langs__brief">KO</span><span class="supported-langs__title">한국어</span></a></li><li class="supported-langs__item"><a class="supported-langs__link" href="https://learn.javascript.ru/fetch-crossorigin"><span class="supported-langs__brief">RU</span><span class="supported-langs__title">Русский</span></a></li><li class="supported-langs__item"><a class="supported-langs__link" href="https://tr.javascript.info/fetch-crossorigin"><span class="supported-langs__brief">TR</span><span class="supported-langs__title">Türkçe</span></a></li><li class="supported-langs__item"><a class="supported-langs__link" href="https://uk.javascript.info/fetch-crossorigin"><span class="supported-langs__brief">UK</span><span class="supported-langs__title">Українська</span></a></li></ul><ul class="supported-langs__list" style="height:20px"><li class="supported-langs__item"><a class="supported-langs__link" href="https://zh.javascript.info/fetch-crossorigin"><span class="supported-langs__brief">ZH</span><span class="supported-langs__title">简体中文</span></a></li></ul></div><div class="supported-langs__text"><p>Queremos que este proyecto de código abierto esté disponible para personas de todo el mundo.</p> <p><a href="https://javascript.info/translate">Ayuda a traducir</a> el contenido de este tutorial a tu idioma!</p>
</div></div></div></div></div></div><div class="sitetoolbar__logo-wrap"><a class="sitetoolbar__link sitetoolbar__link_logo" href="index.html"><img class="sitetoolbar__logo sitetoolbar__logo_normal" src="img/sitetoolbar__logo_en.svg" width="200" alt="" role="presentation"/><img class="sitetoolbar__logo sitetoolbar__logo_normal sitetoolbar__logo_dark" src="img/sitetoolbar__logo_en-white.svg" width="200" alt="" role="presentation"/><img class="sitetoolbar__logo sitetoolbar__logo_small" src="img/sitetoolbar__logo_small_en.svg" width="70" alt="" role="presentation"/><img class="sitetoolbar__logo sitetoolbar__logo_small sitetoolbar__logo_dark" src="img/sitetoolbar__logo_small_en-white.svg" width="70" alt="" role="presentation"/><script>Array.prototype.forEach.call(document.querySelectorAll("img.sitetoolbar__logo"),function(e){let t=document.createElement("object");t.type="image/svg+xml",t.className=e.className,t.style.cssText="left:0;top:0;position:absolute",t.onload=function(){t.onload=null,e.style.visibility="hidden"},t.data=e.src,e.parentNode.insertBefore(t,e)});</script></a></div><div class="sitetoolbar__nav-toggle-wrap"><button class="sitetoolbar__nav-toggle" type="button"></button></div><nav class="sitetoolbar__sections"><ul class="sitetoolbar__sections-list"></ul></nav><div class="sitetoolbar__book-wrap"><a class="buy-book-button" href="ebook.html"><span class="buy-book-button__extra-text">Comprar</span>EPUB/PDF</a></div><div class="sitetoolbar__theme-switcher"><div class="theme-changer"><label class="theme-changer__label" for="theme-changer-input" data-tooltip="Change theme"><input class="theme-changer__input" type="checkbox" id="theme-changer-input" data-theme-changer="data-theme-changer"/><span class="theme-changer__icon theme-changer__icon_light-theme"></span><span class="theme-changer__icon theme-changer__icon_dark-theme"></span></label></div></div><div class="sitetoolbar__search-wrap"><div class="sitetoolbar__search-content"><button class="sitetoolbar__search-toggle" type="button"></button><form class="sitetoolbar__search" method="GET" action="https://es.javascript.info/search"><div class="sitetoolbar__search-input"><div class="text-input"><input class="text-input__control" name="query" placeholder="Buscar en Javascript.info" required="required" type="text"/></div><button class="sitetoolbar__find" type="submit">Buscar</button></div></form></div></div></div><div class="tablet-menu"><div class="tablet-menu__line"><div class="tablet-menu__content"><form class="tablet-menu-search" action="https://es.javascript.info/search/"><input class="tablet-menu-search__input" type="search" name="query" placeholder="Buscar en el tutorial" required="required"/><button class="tablet-menu-search__button" type="submit" name="type" value="articles">Buscar</button></form></div></div><div class="tablet-menu__line"><div class="tablet-menu__content"><a class="map" href="tutorial/map.html" data-action="tutorial-map"><span class="map__text">Mapa del Tutorial</span></a></div></div><div class="tablet-menu__line"><div class="tablet-menu__content"><div class="theme-changer theme-changer_tablet-menu theme-changer_has-label"><label class="theme-changer__label" for="theme-changer-input-tablet" data-tooltip="Change theme"><input class="theme-changer__input" type="checkbox" id="theme-changer-input-tablet" data-theme-changer="data-theme-changer"/><span class="theme-changer__icon theme-changer__icon_light-theme"></span><span class="theme-changer__icon theme-changer__icon_dark-theme"></span><span class="theme-changer__label-text theme-changer__label-text_light-theme">Light theme</span><span class="theme-changer__label-text theme-changer__label-text_dark-theme">Dark theme</span></label></div></div></div><div class="tablet-menu__line"><div class="tablet-menu__content"><div class="share-icons"><span class="share-icons__title">Compartir</span><a class="share share_tw" href="https://twitter.com/share?url=https%3A%2F%2Fes.javascript.info%2Ffetch-crossorigin" rel="nofollow"></a><a class="share share_fb" href="https://www.facebook.com/sharer/sharer.php?s=100&amp;p%5Burl%5D=https%3A%2F%2Fes.javascript.info%2Ffetch-crossorigin" rel="nofollow"></a></div></div></div><div class="tablet-menu__line"><div class="tablet-menu__content"><select class="tablet-menu__nav input-select input-select input-select_small" onchange="if(this.value) window.location.href=this.value"><option value="https://ar.javascript.info/">عربي</option><option value="https://javascript.info/fetch-crossorigin">English</option><option value="https://es.javascript.info/fetch-crossorigin" selected>Español</option><option value="https://fa.javascript.info/">فارسی</option><option value="https://fr.javascript.info/fetch-crossorigin">Français</option><option value="https://id.javascript.info/fetch-crossorigin">Indonesia</option><option value="https://it.javascript.info/fetch-crossorigin">Italiano</option><option value="https://ja.javascript.info/fetch-crossorigin">日本語</option><option value="https://ko.javascript.info/fetch-crossorigin">한국어</option><option value="https://learn.javascript.ru/fetch-crossorigin">Русский</option><option value="https://tr.javascript.info/fetch-crossorigin">Türkçe</option><option value="https://uk.javascript.info/fetch-crossorigin">Українська</option><option value="https://zh.javascript.info/fetch-crossorigin">简体中文</option></select></div></div></div><progress class="tutorial-progress" data-sticky value="5" max="12" data-tooltip="Lección 5 de 12"></progress></div><div class="page page_sidebar_on page_inner_padding"><script>if(localStorage.noSidebar){document.querySelector(".page").classList.remove("page_sidebar_on");let e=document.querySelector(".page-wrapper");e&&e.classList.remove("page-wrapper_sidebar_on")}setTimeout(function(){document.querySelector(".page").classList.add("page_sidebar-animation-on")});</script><div class="page__inner"><main class="main main_width-limit"><header class="main__header"><div class="main__header-inner"><div class="main__header-group"><ol class="breadcrumbs"><li class="breadcrumbs__item breadcrumbs__item_home"><a class="breadcrumbs__link" href="index.html"><span class="breadcrumbs__hidden-text">Tutorial</span></a></li><li class="breadcrumbs__item" id="breadcrumb-1"><a class="breadcrumbs__link" href="network.html"><span>Solicitudes de red</span></a></li><script type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Tutorial","item":"https://es.javascript.info/"},{"@type":"ListItem","position":2,"name":"Solicitudes de red","item":"https://es.javascript.info/network"}]}</script></ol><div class="updated-at" data-tooltip="Última actualización el 19 de noviembre de 2022"><div class="updated-at__content">19 de noviembre de 2022</div></div></div><h1 class="main__header-title">Fetch: Cross-Origin Requests</h1></div></header><div class="content"><article class="formatted" itemscope itemtype="http://schema.org/TechArticle"><meta itemprop="name" content="Fetch: Cross-Origin Requests"><div itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="email" content="iliakan@gmail.com"><meta itemprop="name" content="Ilya Kantor"></div><div itemprop="articleBody"><p>Si enviamos una petición <code>fetch</code> hacia otro sitio seguramente fallará.</p>
<p>Por ejemplo, probemos una petición a <code>https://example.com</code>:</p>
<div id="81lftjjfla" data-trusted="1" class="code-example" data-async="1">
      <div class="codebox code-example__codebox">
        
        <div class="toolbar codebox__toolbar">
          <div class="toolbar__tool">
            <a href="#" title="ejecutar" data-action="run" class="toolbar__button toolbar__button_run"></a>
          </div>
          <div class="toolbar__tool">
            <a href="#" title="abrir en entorno controlado" target="_blank" data-action="edit" class="toolbar__button toolbar__button_edit"></a>
          </div>
        </div>
        <div class="codebox__code" data-code="1">
          <pre class="line-numbers language-javascript"><code>try {
  await fetch('https://example.com');
} catch(err) {
  alert(err); // Failed to fetch
}</code></pre>
        </div>
      </div>
      
      </div><p>El método fetch falla, tal como lo esperábamos.</p>
<p>El concepto clave aquí es <em>el origen</em> (<em>origin</em>), triple combinación de dominio/puerto/protocolo.</p>
<p>Las solicitudes de origen cruzado <code>Cross-origin requests</code> (aquellas que son enviadas hacia otro dominio --incluso subdominio–, protocolo o puerto), requieren de unas cabeceras especiales desde el sitio remoto.</p>
<p>Esta política es denominada “CORS”, por sus siglas en inglés Cross-Origin Resource Sharing.</p>
<h2><a class="main__anchor" name="por-que-cors-es-necesario-una-breve-historia" href="#por-que-cors-es-necesario-una-breve-historia">¿Por que CORS es necesario?, Una breve historia</a></h2><p>CORS existe para proteger Internet de los hackers malvados.</p>
<p>En verdad… Déjame contarte un breve resumen de esta historia.</p>
<p><strong>Durante muchos años un script de un sitio no podía acceder al contenido de otro sitio.</strong></p>
<p>Esta simple, pero poderosa regla, fue parte fundacional de la seguridad de Internet. Por ejemplo, un script malicioso desde el sitio <code>hacker.com</code> no podía acceder a la casilla de correo en el sitio <code>gmail.com</code>. La gente se podía sentir segura.</p>
<p>Así mismo en ese momento, JavaScript no tenía ningún método especial para realizar solicitudes de red. Simplemente era un lenguaje juguete para decorar páginas web.</p>
<p>Pero los desarrolladores web demandaron más poder. Una variedad de trucos fueron inventados para poder pasar por alto las limitaciones, y realizar solicitudes a otros sitios.</p>
<h3><a class="main__anchor" name="utilizando-formularios" href="#utilizando-formularios">Utilizando formularios</a></h3><p>Una forma de comunicarse con otros servidores es y era utilizando un <code>&lt;form&gt;</code>. Se lo utilizaba para enviar el resultado hacia un <code>&lt;iframe&gt;</code>, y de este modo mantenerse en el mismo sitio:</p>
<div id="xachsllr47" data-trusted="1" class="code-example" data-highlight="[{&quot;start&quot;:4,&quot;end&quot;:4},{&quot;start&quot;:1,&quot;end&quot;:1}]">
      <div class="codebox code-example__codebox">
        
        <div class="codebox__code" data-code="1">
          <pre class="line-numbers language-markup"><code>&lt;!-- objetivo del form --&gt;
&lt;iframe name=&quot;iframe&quot;&gt;&lt;/iframe&gt;

&lt;!-- Un formulario puede ser generado de forma dinámica y ser enviado por JavaScript --&gt;
&lt;form target=&quot;iframe&quot; method=&quot;POST&quot; action=&quot;http://another.com/…&quot;&gt;
  ...
&lt;/form&gt;</code></pre>
        </div>
      </div>
      
      </div><p>Entonces, de este modo era posible realizar solicitudes GET/POST hacia otro sitio, incluso sin métodos de red, ya que los formularios pueden enviar mensajes a cualquier sitio. Pero ya que no es posible acceder al contenido de un <code>&lt;iframe&gt;</code> de otro sitio, esto evita que sea posible leer la respuesta.</p>
<p>Para ser precisos, en realidad había trucos para eso, requerían scripts especiales tanto en el iframe como en la página. Entonces la comunicación con el iframe era técnicamente posible. Pero ya no hay necesidad de entrar en detalles, dejemos a los dinosaurios descansar en paz.</p>
<h3><a class="main__anchor" name="utilizando-scripts" href="#utilizando-scripts">Utilizando scripts</a></h3><p>Otro truco es en el modo de utilizar la etiqueta <code>script</code>. Un script puede tener cualquier origen <code>src</code>, con cualquier dominio, tal como <code>&lt;script src=&quot;http://another.com/…&quot;&gt;</code>. De este modo es posible ejecutar un script de cualquier sitio web.</p>
<p>Si un sitio, por ejemplo, <code>another.com</code> requiere exponer datos con este tipo de acceso, se utilizaba el protocolo llamado en ese entonces “JSONP (JSON con padding)” .</p>
<p>Veamos como se utilizaba.</p>
<p>Digamos que, en nuestro sitio es necesario obtener datos de <code>http://another.com</code>, como podría ser el pronóstico del tiempo:</p>
<ol>
<li>
<p>Primero, adelantándonos, creamos una función global para aceptar los datos, por ejemplo: <code>gotWeather</code>.</p>
<div id="b268qqemij" data-trusted="1" class="code-example">
      <div class="codebox code-example__codebox">
        
        <div class="codebox__code" data-code="1">
          <pre class="line-numbers language-javascript"><code>// 1. Se declara la función para procesar los datos del tiempo
function gotWeather({ temperature, humidity }) {
  alert(`temperature: ${temperature}, humidity: ${humidity}`);
}</code></pre>
        </div>
      </div>
      
      </div></li>
<li>
<p>Entonces creamos una etiqueta <code>&lt;script&gt;</code> donde <code>src=&quot;http://another.com/weather.json?callback=gotWeather&quot;</code>, utilizando el nombre de nuestra función como un parámetro <code>callback</code>, dentro de la URL.</p>
<div id="6qto955v71" data-trusted="1" class="code-example">
      <div class="codebox code-example__codebox">
        
        <div class="codebox__code" data-code="1">
          <pre class="line-numbers language-javascript"><code>let script = document.createElement('script');
script.src = `http://another.com/weather.json?callback=gotWeather`;
document.body.append(script);</code></pre>
        </div>
      </div>
      
      </div></li>
<li>
<p>El servidor remoto <code>another.com</code> de forma dinámica genera un script que invoca el método <code>gotWeather(...)</code> con los datos que nosotros necesitamos recibir.</p>
<div id="u4ifel0p1d" data-trusted="1" class="code-example">
      <div class="codebox code-example__codebox">
        
        <div class="codebox__code" data-code="1">
          <pre class="line-numbers language-javascript"><code>// The expected answer from the server looks like this:
gotWeather({
  temperature: 25,
  humidity: 78
});</code></pre>
        </div>
      </div>
      
      </div></li>
<li>
<p>Entonces el script remoto carga y es ejecutado, la función <code>gotWeather</code> se invoca, y ya que es nuestra función, obtenemos los datos.</p>
</li>
</ol>
<p>Esto funciona, y no viola la seguridad ya que ambos sitios acuerdan en intercambiar los datos de este modo. Y cuando ambos lados concuerdan, definitivamente no se trata de un hackeo. Aún hay servicios que proveen este tipo de acceso, lo que puede ser útil ya que funciona en navegadores obsoletos.</p>
<p>Tiempo después aparecieron métodos de red en los navegadores para JavaScript.</p>
<p>Al comienzo, las solicitudes de origen cruzado fueron prohibidas, pero luego de prolongadas discusiones se permitieron, requiriendo consentimiento explicito por parte del servidor, esto expresado en cabezales especiales.</p>
<h2><a class="main__anchor" name="solicitudes-seguras" href="#solicitudes-seguras">Solicitudes seguras</a></h2><p>Existen dos tipos de solicitudes de origen cruzado:</p>
<ol>
<li>Solicitudes seguras.</li>
<li>Todas las demás.</li>
</ol>
<p>Las solicitudes seguras son más fáciles de hacer, comencemos con ellas.</p>
<p>Una solicitud es segura si cumple dos condiciones:</p>
<ol>
<li><a href="https://fetch.spec.whatwg.org/#cors-safelisted-method">método seguro</a>: GET, POST o HEAD</li>
<li><a href="https://fetch.spec.whatwg.org/#cors-safelisted-request-header">Cabeceras seguras</a> – Las únicas cabeceras permitidas son:
<ul>
<li><code>Accept</code>,</li>
<li><code>Accept-Language</code>,</li>
<li><code>Content-Language</code>,</li>
<li><code>Content-Type</code> con el valor <code>application/x-www-form-urlencoded</code>, <code>multipart/form-data</code> o <code>text/plain</code>.</li>
</ul>
</li>
</ol>
<p>Cualquier otra solicitud es considerada “insegura”. Por lo tanto, una solicitud con el método <code>PUT</code> o con una cabecera HTTP <code>API-Key</code> no cumple con las limitaciones.</p>
<p><strong>La diferencia esencial es que una solicitud segura puede ser realizada mediante un <code>&lt;form&gt;</code> o un <code>&lt;script&gt;</code>, sin la necesidad de utilizar un método especial.</strong></p>
<p>Por lo tanto, incluso un servidor obsoleto debería ser capaz de aceptar una solicitud segura.</p>
<p>Contrario a esto, las solicitudes con cabeceras no estándar o métodos como el <code>DELETE</code> no pueden ser creados de este modo. Durante mucho tiempo no fue posible para JavaScript realizar este tipo de solicitudes. Por lo que un viejo servidor podía asumir que ese tipo de solicitudes provenía desde una fuente privilegiada, “ya que una página web es incapaz de enviarlas”.</p>
<p>Cuando intentamos realizar una solicitud insegura, el navegador envía una solicitud especial de “pre-vuelo” consultando al servidor: ¿está de acuerdo en aceptar tal solicitud de origen cruzado o no?</p>
<p>Y, salvo que el servidor lo confirme de forma explícita, cualquier solicitud insegura no es enviada.</p>
<p>Vayamos ahora a los detalles.</p>
<h2><a class="main__anchor" name="cors-para-solicitudes-seguras" href="#cors-para-solicitudes-seguras">CORS para solicitudes seguras</a></h2><p>Si una solicitud es de origen cruzado, el navegador siempre le agregará una cabecera <code>Origin</code>.</p>
<p>Por ejemplo, si realizamos una solicitud de <code>https://anywhere.com/request</code> a <code>https://javascript.info/page</code>, las cabeceras podrían ser algo así:</p>
<div id="ahddjz0gh3" data-trusted="1" class="code-example" data-highlight="[{&quot;start&quot;:2,&quot;end&quot;:2}]">
      <div class="codebox code-example__codebox">
        
        <div class="codebox__code" data-code="1">
          <pre class="line-numbers language-http"><code>GET /request
Host: anywhere.com
Origin: https://javascript.info
...</code></pre>
        </div>
      </div>
      
      </div><p>Tal como se puede ver, la cabecera <code>Origin</code> contiene exactamente el origen (protocolo/dominio/puerto), sin el path.</p>
<p>El servidor puede inspeccionar el origen <code>Origin</code> y, si esta de acuerdo en aceptar ese tipo de solicitudes, agrega una cabecera especial <code>Access-Control-Allow-Origin</code> a la respuesta. Esta cabecera debe contener el origen permitido (en nuestro caso <code>https://javascript.info</code>), o un asterisco <code>*</code>. En ese caso la respuesta es satisfactoria, de otro modo falla.</p>
<p>El navegador cumple el papel de mediador de confianza:</p>
<ol>
<li>Ante una solicitud de origen cruzado, se asegura de que se envíe el origen correcto.</li>
<li>Chequea que la respuesta contenga la cabecera <code>Access-Control-Allow-Origin</code>, de ser así JavaScript tiene permitido acceder a la respuesta, de no ser así la solicitud falla con un error.</li>
</ol>
<figure><div class="image" style="width:633px">
      <div class="image__ratio" style="padding-top:64.92890995260665%"></div>
      <object type="image/svg+xml" data="article/fetch-crossorigin/xhr-another-domain.svg" width="633" height="411" class="image__image" data-use-theme>
        <img src="article/fetch-crossorigin/xhr-another-domain.svg" alt="" width="633" height="411">
      </object>
      </div></figure><p>Aquí tenemos un ejemplo de una respuesta permisiva desde el servidor:</p>
<div id="z4alqfijmw" data-trusted="1" class="code-example" data-highlight="[{&quot;start&quot;:2,&quot;end&quot;:2}]">
      <div class="codebox code-example__codebox">
        
        <div class="codebox__code" data-code="1">
          <pre class="line-numbers language-http"><code>200 OK
Content-Type:text/html; charset=UTF-8
Access-Control-Allow-Origin: https://javascript.info</code></pre>
        </div>
      </div>
      
      </div><h2><a class="main__anchor" name="cabeceras-de-respuesta" href="#cabeceras-de-respuesta">Cabeceras de respuesta</a></h2><p>Para las respuestas de origen cruzado, por defecto JavaScript sólo puede acceder a las cabeceras llamadas “seguras”:</p>
<ul>
<li><code>Cache-Control</code></li>
<li><code>Content-Language</code></li>
<li><code>Content-Length</code></li>
<li><code>Content-Type</code></li>
<li><code>Expires</code></li>
<li><code>Last-Modified</code></li>
<li><code>Pragma</code></li>
</ul>
<p>El acceso a otro tipo de cabeceras de la respuesta generará un error.</p>
<p>Para permitir a JavaScript acceso a cualquier otra cabecera de respuesta, el servidor debe incluir la cabecera <code>Access-Control-Expose-Headers</code>. Este campo contiene una lista separada por comas de las cabeceras inseguras que podrán ser accesibles.</p>
<p>Por ejemplo:</p>
<div id="mjdh82k66v" data-trusted="1" class="code-example" data-highlight="[{&quot;start&quot;:6,&quot;end&quot;:6}]">
      <div class="codebox code-example__codebox">
        
        <div class="codebox__code" data-code="1">
          <pre class="line-numbers language-http"><code>200 OK
Content-Type:text/html; charset=UTF-8
Content-Length: 12345
Content-Encoding: gzip
API-Key: 2c9de507f2c54aa1
Access-Control-Allow-Origin: https://javascript.info
Access-Control-Expose-Headers: Content-Encoding,API-Key</code></pre>
        </div>
      </div>
      
      </div><p>Con tal cabecera, <code>Access-Control-Expose-Headers</code>, el script tendrá permitido acceder a los valores de las cabeceras <code>Content-Encoding</code> y <code>API-Key</code> de la respuesta.</p>
<h2><a class="main__anchor" name="solicitudes-inseguras" href="#solicitudes-inseguras">Solicitudes “inseguras”</a></h2><p>Podemos utilizar cualquier método HTTP: no únicamente <code>GET/POST</code>, sino también <code>PATCH</code>, <code>DELETE</code> y otros.</p>
<p>Hace algún tiempo nadie podía siquiera imaginar que un sitio web pudiera realizar ese tipo de solicitudes. Por lo que aún existen servicios web que cuando reciben un método no estándar los consideran como una señal de que: “Del otro lado no hay un navegador”. Ellos pueden tener en cuenta esto cuando revisan los derechos de acceso.</p>
<p>Por lo tanto, para evitar malentendidos, cualquier solicitud “insegura” (Estas que no podían ser realizadas en los viejos tiempos), no será realizada por el navegador en forma directa. Antes, enviará una solicitud preliminar llamada solicitud de “pre-vuelo”, solicitando que se le concedan los permisos.</p>
<p>Una solicitud de “pre-vuelo” utiliza el método <code>OPTIONS</code>, sin contenido en el cuerpo y con tres cabeceras:</p>
<ul>
<li><code>Access-Control-Request-Method</code>, cabecera que contiene el método de la solicitud “insegura”.</li>
<li><code>Access-Control-Request-Headers</code> provee una lista separada por comas de las cabeceras inseguras de la solicitud.</li>
<li><code>Origin</code> cabecera que informa de dónde viene la solicitud. (como <code>https://javascript.info</code>)</li>
</ul>
<p>Si el servidor está de acuerdo con lo solicitado, entonces responderá con el código de estado 200 y un cuerpo vacío:</p>
<ul>
<li><code>Access-Control-Allow-Origin</code> debe ser <code>*</code> o el origen de la solicitud, tal como <code>https://javascript.info</code>, para permitir el acceso.</li>
<li><code>Access-Control-Allow-Methods</code> contiene el método permitido.</li>
<li><code>Access-Control-Allow-Headers</code> contiene un listado de las cabeceras permitidas.</li>
<li>Además, la cabecera <code>Access-Control-Max-Age</code> puede especificar el número máximo de segundos que puede recordar los permisos. Por lo que el navegador no necesita volver a requerirlos en las próximas solicitudes.</li>
</ul>
<figure><div class="image" style="width:620px">
      <div class="image__ratio" style="padding-top:102.09677419354838%"></div>
      <object type="image/svg+xml" data="article/fetch-crossorigin/xhr-preflight.svg" width="620" height="633" class="image__image" data-use-theme>
        <img src="article/fetch-crossorigin/xhr-preflight.svg" alt="" width="620" height="633">
      </object>
      </div></figure><p>Vamos a ver cómo funciona paso a paso, mediante un ejemplo para una solicitud de origen cruzado <code>PATCH</code> (este método suele utilizarse para actualizar datos):</p>
<div id="3ig5onagng" data-trusted="1" class="code-example">
      <div class="codebox code-example__codebox">
        
        <div class="codebox__code" data-code="1">
          <pre class="line-numbers language-javascript"><code>let response = await fetch('https://site.com/service.json', {
  method: 'PATCH',
  headers: {
    'Content-Type': 'application/json',
    'API-Key': 'secret'
  }
});</code></pre>
        </div>
      </div>
      
      </div><p>Hay tres motivos por los cuales esta solicitud no es segura (una es suficiente):</p>
<ul>
<li>Método <code>PATCH</code></li>
<li><code>Content-Type</code> no es del tipo: <code>application/x-www-form-urlencoded</code>, <code>multipart/form-data</code>, <code>text/plain</code>.</li>
<li>Cabecera <code>API-Key</code> “insegura”.</li>
</ul>
<h3><a class="main__anchor" name="paso-1-solicitud-de-pre-vuelo" href="#paso-1-solicitud-de-pre-vuelo">Paso 1 (solicitud de pre-vuelo)</a></h3><p>Antes de enviar una solicitud de este tipo, el navegador envía una solicitud de pre-vuelo que se ve de este modo:</p>
<div id="5ey7vzaz7f" data-trusted="1" class="code-example">
      <div class="codebox code-example__codebox">
        
        <div class="codebox__code" data-code="1">
          <pre class="line-numbers language-http"><code>OPTIONS /service.json
Host: site.com
Origin: https://javascript.info
Access-Control-Request-Method: PATCH
Access-Control-Request-Headers: Content-Type,API-Key</code></pre>
        </div>
      </div>
      
      </div><ul>
<li>Método: <code>OPTIONS</code>.</li>
<li>El path – exactamente el mismo que el de la solicitud principal: <code>/service.json</code>.</li>
<li>Cabeceras especiales de origen cruzado (Cross-origin):
<ul>
<li><code>Origin</code> – el origen de la fuente.</li>
<li><code>Access-Control-Request-Method</code> – método solicitado.</li>
<li><code>Access-Control-Request-Headers</code> – listado separado por comas de las cabeceras “inseguras”.</li>
</ul>
</li>
</ul>
<h3><a class="main__anchor" name="paso-2-solicitud-de-pre-vuelo" href="#paso-2-solicitud-de-pre-vuelo">Paso 2 (solicitud de pre-vuelo)</a></h3><p>El servidor debe responder con el código de estado 200 y las cabeceras:</p>
<ul>
<li><code>Access-Control-Allow-Origin: https://javascript.info</code></li>
<li><code>Access-Control-Allow-Methods: PATCH</code></li>
<li><code>Access-Control-Allow-Headers: Content-Type,API-Key</code>.</li>
</ul>
<p>Esto permitirá la comunicación futura, de otro modo se disparará un error.</p>
<p>Si el servidor espera otro método y cabeceras en el futuro, tiene sentido permitirlos por adelantado agregándolos a la lista.</p>
<p>Por ejemplo, esta respuesta habilita además los métodos <code>PUT</code>, <code>DELETE</code> y otras cabeceras:</p>
<div id="enzcu0m1jb" data-trusted="1" class="code-example">
      <div class="codebox code-example__codebox">
        
        <div class="codebox__code" data-code="1">
          <pre class="line-numbers language-http"><code>200 OK
Access-Control-Allow-Origin: https://javascript.info
Access-Control-Allow-Methods: PUT,PATCH,DELETE
Access-Control-Allow-Headers: API-Key,Content-Type,If-Modified-Since,Cache-Control
Access-Control-Max-Age: 86400</code></pre>
        </div>
      </div>
      
      </div><p>Ahora el navegador puede ver que <code>PATCH</code> se encuentra dentro de la cabecera <code>Access-Control-Allow-Methods</code> y <code>Content-Type,API-Key</code> dentro de la lista <code>Access-Control-Allow-Headers</code>, por lo que permitirá enviar la solicitud principal.</p>
<p>Si se encuentra con una cabecera <code>Access-Control-Max-Age</code> con determinada cantidad de segundos, entonces los permisos son almacenados en el caché por ese determinado tiempo. La solicitud anterior será cacheada por 86400 segundos (un día). Durante ese marco de tiempo, las solicitudes siguientes no requerirán la solicitud de pre-vuelo. Asumiendo que están dentro de lo permitido en la respuesta cacheada, serán enviadas de forma directa.</p>
<h3><a class="main__anchor" name="paso-3-solicitud-real" href="#paso-3-solicitud-real">Paso 3 (solicitud real)</a></h3><p>Una vez el pre-vuelo se realiza de forma satisfactoria, el navegador realiza la solicitud principal. El algoritmo aquí es el mismo que el utilizado para una solicitud segura.</p>
<p>La solicitud principal tiene la cabecera <code>Origin</code> (ya que se trata de una solicitud de origen cruzado):</p>
<div id="6nnbkqved4" data-trusted="1" class="code-example">
      <div class="codebox code-example__codebox">
        
        <div class="codebox__code" data-code="1">
          <pre class="line-numbers language-http"><code>PATCH /service.json
Host: site.com
Content-Type: application/json
API-Key: secret
Origin: https://javascript.info</code></pre>
        </div>
      </div>
      
      </div><h3><a class="main__anchor" name="paso-4-respuesta-real" href="#paso-4-respuesta-real">Paso 4 (respuesta real)</a></h3><p>El server no debe olvidar agregar la cabecera <code>Access-Control-Allow-Origin</code> a la respuesta principal. Un pre-vuelo exitoso no lo libera de esto:</p>
<div id="4jfvdxfme2" data-trusted="1" class="code-example">
      <div class="codebox code-example__codebox">
        
        <div class="codebox__code" data-code="1">
          <pre class="line-numbers language-http"><code>Access-Control-Allow-Origin: https://javascript.info</code></pre>
        </div>
      </div>
      
      </div><p>Entonces JavaScript es capaz de leer la respuesta principal del servidor.</p>
<div class="important important_smart">
            <div class="important__header"><span class="important__type">Por favor tome nota:</span></div>
            <div class="important__content"><p>La solicitud de pre-vuelo ocurre “detrás de escena”, es invisible a JavaScript.</p>
<p>JavaScript únicamente obtiene la respuesta a la solicitud principal o un error en caso de que el servidor no otorgue la autorización.</p>
</div></div>
<h2><a class="main__anchor" name="credenciales" href="#credenciales">Credenciales</a></h2><p>Una solicitud de origen cruzado realizada por código JavaScript, por defecto no provee ningún tipo de credenciales (cookies o autenticación HTTP).</p>
<p>Esto es poco común para solicitudes HTTP. Usualmente una solicitud a un sitio <code>http://site.com</code> es acompañada por todas las cookies de ese dominio. Pero una solicitud de origen cruzado realizada por métodos de JavaScript son una excepción.</p>
<p>Por ejemplo, <code>fetch('http://another.com')</code> no enviará ninguna cookie, ni siquiera (!) esas que pertenecen al dominio <code>another.com</code>.</p>
<p>¿Por qué?</p>
<p>El motivo de esto es que una solicitud con credenciales es mucho más poderosa que sin ellas. Si se permitiera, esto garantizaría a JavaScript el completo poder de actuar en representación del usuario y de acceder a información sensible utilizando sus credenciales.</p>
<p>¿En verdad el servidor confía lo suficiente en el script? En ese caso el servidor debera enviar explicitamente que permite solicitudes con credenciales mediante otra cabecera especial.</p>
<p>Para permitir el envío de credenciales en <code>fetch</code>, necesitamos agregar la opción <code>credentials: &quot;include&quot;</code>, de este modo:</p>
<div id="ug2pqdyrxu" data-trusted="1" class="code-example">
      <div class="codebox code-example__codebox">
        
        <div class="codebox__code" data-code="1">
          <pre class="line-numbers language-javascript"><code>fetch('http://another.com', {
  credentials: &quot;include&quot;
});</code></pre>
        </div>
      </div>
      
      </div><p>Ahora <code>fetch</code> envía cookies originadas desde <code>another.com</code> con las solicitudes a ese sitio.</p>
<p>Si el servidor está de acuerdo en aceptar solicitudes <em>con credenciales</em>, debe agregar la cabecera <code>Access-Control-Allow-Credentials: true</code> a la respuesta, además de <code>Access-Control-Allow-Origin</code>.</p>
<p>Por ejemplo:</p>
<div id="0klmpkoh3u" data-trusted="1" class="code-example">
      <div class="codebox code-example__codebox">
        
        <div class="codebox__code" data-code="1">
          <pre class="line-numbers language-http"><code>200 OK
Access-Control-Allow-Origin: https://javascript.info
Access-Control-Allow-Credentials: true</code></pre>
        </div>
      </div>
      
      </div><p>Cabe destacar que: <code>Access-Control-Allow-Origin</code> no se puede utilizar con un asterisco <code>*</code> para solicitudes con credenciales. Tal como se muestra a arriba debe proveer el origen exacto. Esto es una medida adicional de seguridad, para asegurar de que el servidor conozca exactamente en quién confiar para que le envíe este tipo de solicitudes.</p>
<h2><a class="main__anchor" name="resumen" href="#resumen">Resumen</a></h2><p>Desde el punto de vista del navegador, existen dos tipos de solicitudes de origen cruzado: solicitudes “seguras” y todas las demás.</p>
<p><a href="http://www.w3.org/TR/cors/#terminology">Solicitudes seguras</a> deben cumplir las siguientes condiciones:</p>
<ul>
<li>Método: GET, POST o HEAD.</li>
<li>Cabeceras – solo podemos establecer:
<ul>
<li><code>Accept</code></li>
<li><code>Accept-Language</code></li>
<li><code>Content-Language</code></li>
<li><code>Content-Type</code> con el valor <code>application/x-www-form-urlencoded</code>, <code>multipart/form-data</code> o <code>text/plain</code>.</li>
</ul>
</li>
</ul>
<p>La diferencia esencial es que las solicitudes seguras eran posibles desde los viejos tiempos utilizando las etiquetas <code>&lt;form&gt;</code> o <code>&lt;script&gt;</code>, mientras que las solicitudes “inseguras” fueron imposibles para el navegador durante mucho tiempo.</p>
<p>Por lo tanto, en la práctica, la diferencia se encuentra en que las solicitudes seguras son realizadas de forma directa, utilizando la cabecera <code>Origin</code>, mientras que para las otras el navegador realiza una solicitud extra de “pre-vuelo” para requerir la autorización.</p>
<p><strong>Para una solicitud segura:</strong></p>
<ul>
<li>→ El navegador envía una cabecera <code>Origin</code> con el origen.</li>
<li>← Para solicitudes sin credenciales (no enviadas por defecto), el servidor debe establecer:
<ul>
<li><code>Access-Control-Allow-Origin</code> como <code>*</code> o el mismo valor que en <code>Origin</code>.</li>
</ul>
</li>
<li>← Para solicitudes con credenciales, el servidor deberá establecer:
<ul>
<li><code>Access-Control-Allow-Origin</code> con el mismo valor que en <code>Origin</code>.</li>
<li><code>Access-Control-Allow-Credentials</code> en <code>true</code></li>
</ul>
</li>
</ul>
<p>Adicionalmente, para garantizar a JavaScript acceso a cualquier cabecera de la respuesta, con excepción de <code>Cache-Control</code>, <code>Content-Language</code>, <code>Content-Type</code>, <code>Expires</code>, <code>Last-Modified</code> o <code>Pragma</code>, el servidor debe agregarlas como permitidas en la lista de la cabecera <code>Access-Control-Expose-Headers</code>.</p>
<p><strong>Para solicitudes inseguras, se utiliza una solicitud preliminar “pre-vuelo”  antes de la solicitud principal:</strong></p>
<ul>
<li>→ El navegador envía una solicitud del tipo <code>OPTIONS</code> a la misma URL, con las cabeceras:
<ul>
<li><code>Access-Control-Request-Method</code> con el método requerido.</li>
<li><code>Access-Control-Request-Headers</code> listado de las cabeceras inseguras.</li>
</ul>
</li>
<li>← El servidor debe responder con el código de estado 200 y las cabeceras:
<ul>
<li><code>Access-Control-Allow-Methods</code> con la lista de todos los métodos permitidos,</li>
<li><code>Access-Control-Allow-Headers</code> con una lista de cabeceras permitidas,</li>
<li><code>Access-Control-Max-Age</code> con los segundos en los que se podrá almacenar la autorización en caché.</li>
</ul>
</li>
<li>Tras lo cual la solicitud es enviada, y se aplica el esquema previo “seguro”.</li>
</ul>
</div></article><div class="tasks formatted"><h2 class="tasks__title" id="tasks"><a class="tasks__title-anchor main__anchor main__anchor main__anchor_noicon" href="#tasks">Tareas</a></h2><div class="task tasks__task"><div class="task__header"><div class="task__title-wrap"><h3 class="task__title"><a class="main__anchor" href="#por-que-necesitamos-el-origen-origin" name="por-que-necesitamos-el-origen-origin">¿Por que necesitamos el origen (Origin)?</a></h3><a class="task__open-link" href="task/do-we-need-origin.html" target="_blank"></a></div><div class="task__header-note"><span class="task__importance" title="Qué tan importante es la tarea, del 1 a 5">importancia: 5</span></div><div class="task__content"><div class="task__formatted"><p>Como seguramente ya sepas, existe la cabecera HTTP <code>Referer</code>, la cual por lo general contiene la url del sitio que generó la solicitud.</p>
<p>Por ejemplo, cuando solicitamos la url <code>http://google.com</code> desde <code>http://javascript.info/alguna/url</code>, las cabeceras se ven de este modo:</p>
<div id="pdwo5z0qbk" data-trusted="1" class="code-example" data-highlight="[{&quot;start&quot;:5,&quot;end&quot;:6}]">
      <div class="codebox code-example__codebox">
        
        <div class="codebox__code" data-code="1">
          <pre class="line-numbers language-none"><code>Accept: */*
Accept-Charset: utf-8
Accept-Encoding: gzip,deflate,sdch
Connection: keep-alive
Host: google.com
Origin: http://javascript.info
Referer: http://javascript.info/alguna/url</code></pre>
        </div>
      </div>
      
      </div><p>Tal como se puede ver, tanto <code>Referer</code> como <code>Origin</code> están presentes.</p>
<p>Las preguntas:</p>
<ol>
<li>¿Por qué la cabecera <code>Origin</code> es necesaria, si <code>Referer</code> contiene incluso más información?</li>
<li>¿Es posible que no se incluya <code>Referer</code> u <code>Origin</code>, o que contengan datos incorrectos?</li>
</ol>
</div><button class="task__solution" type="button">solución</button><div class="task__answer"><div class="task__answer-content"><div class="formatted"><p>Necesitamos la cabecera <code>Origin</code>, ya que en algunos casos <code>Referer</code> no está presente. Por ejemplo, cuando realizamos un <code>fetch</code> a una página HTTP desde una HTTPS (acceder a un sitio menos seguro desde uno más seguro), en ese caso no tendremos el campo <code>Referer</code>.</p>
<p>La <a href="http://en.wikipedia.org/wiki/Content_Security_Policy">Política de seguridad de contenido</a> puede prohibir el envío de <code>Referer</code>.</p>
<p>Como veremos, <code>fetch</code> tiene opciones con las que es posible evitar el envío de <code>Referer</code> e incluso permite su modificación (dentro del mismo sitio).</p>
<p>Por especificación, <code>Referer</code> es una cabecera HTTP opcional.</p>
<p>Por el hecho de que <code>Referer</code> no es confiable, la cabecera <code>Origin</code> ha sido creada. El navegador garantiza el envío correcto de <code>Origin</code> para las solicitudes de origen cruzado.</p>
</div></div><button class="close-button task__answer-close" type="button" title="cerrar"></button></div></div></div></div></div></div><div class="page__nav-wrap"><a class="page__nav page__nav_prev" href="fetch-abort.html" data-tooltip="Fetch: Abort"><span class="page__nav-text"><span class="page__nav-text-shortcut"></span></span><span class="page__nav-text-alternate">Lección anterior</span></a><a class="page__nav page__nav_next" href="fetch-api.html" data-tooltip="Fetch API"><span class="page__nav-text"><span class="page__nav-text-shortcut"></span></span><span class="page__nav-text-alternate">Próxima lección</span></a></div><div class="article-tablet-foot tablet-only"><div class="article-tablet-foot__layout"><div class="share-icons"><span class="share-icons__title">Compartir</span><a class="share share_tw" href="https://twitter.com/share?url=https%3A%2F%2Fes.javascript.info%2Ffetch-crossorigin" rel="nofollow"></a><a class="share share_fb" href="https://www.facebook.com/sharer/sharer.php?s=100&amp;p%5Burl%5D=https%3A%2F%2Fes.javascript.info%2Ffetch-crossorigin" rel="nofollow"></a></div><div class="article-tablet-foot__map"><a class="map" href="tutorial/map.html" data-action="tutorial-map"><span class="map__text">Mapa del Tutorial</span></a></div></div></div><div class="comments formatted" id="comments"><div class="comments__header"><h2 class="comments__header-title"><a href="#comments" name="comments">Comentarios</a></h2><div class="comments__read-before"><span class="comments__read-before-link">lea esto antes de comentar…</span><div class="comments__read-before-popup"><div class="comments__read-before-popup-i"><ul><li>Si tiene sugerencias sobre qué mejorar, por favor <a href="https://github.com/javascript-tutorial/en.javascript.info/issues/new">enviar una propuesta de GitHub</a> o una solicitud de extracción en lugar de comentar.</li><li>Si no puede entender algo en el artículo, por favor explique.</li><li>Para insertar algunas palabras de código, use la etiqueta <code>&lt;code&gt;</code>, para varias líneas – envolverlas en la etiqueta <code>&lt;pre&gt;</code>, para más de 10 líneas – utilice una entorno controlado (sandbox) (<a href='https://plnkr.co/edit/?p=preview'>plnkr</a>, <a href='https://jsbin.com/'>jsbin</a>, <a href='http://codepen.io/'>codepen</a>…)</li></ul></div></div></div></div><div id="disqus_thread"></div><script>var disqus_config = function() { if (!this.page) this.page = {}; Object.assign(this.page, {"url":"https:\/\/es.javascript.info\/fetch-crossorigin","identifier":"\/fetch-crossorigin"}); };</script><script>var disqus_shortname = "es-javascript-info";</script><script>var disqus_enabled = true;</script></div></main></div><div class="sidebar page__sidebar sidebar sidebar_sticky-footer"><button class="sidebar__toggle" data-sidebar-toggle></button><a class="map" href="tutorial/map.html" data-action="tutorial-map" data-tooltip="Mapa del Tutorial"></a><div class="sidebar__inner"><div class="sidebar__content"><div class="sidebar__section"><h4 class="sidebar__section-title">Capítulo</h4><nav class="sidebar__navigation"><ul class="sidebar__navigation-links"><li class="sidebar__navigation-link"><a class="sidebar__link" href="network.html">Solicitudes de red</a></li></ul></nav></div><div class="sidebar__section"><h4 class="sidebar__section-title">Navegación de lección</h4><nav class="sidebar__navigation"><ul class="sidebar__navigation-links"><li class="sidebar__navigation-link"><a class="sidebar__link" href="#por-que-cors-es-necesario-una-breve-historia">¿Por que CORS es necesario?, Una breve historia</a></li><li class="sidebar__navigation-link"><a class="sidebar__link" href="#solicitudes-seguras">Solicitudes seguras</a></li><li class="sidebar__navigation-link"><a class="sidebar__link" href="#cors-para-solicitudes-seguras">CORS para solicitudes seguras</a></li><li class="sidebar__navigation-link"><a class="sidebar__link" href="#cabeceras-de-respuesta">Cabeceras de respuesta</a></li><li class="sidebar__navigation-link"><a class="sidebar__link" href="#solicitudes-inseguras">Solicitudes “inseguras”</a></li><li class="sidebar__navigation-link"><a class="sidebar__link" href="#credenciales">Credenciales</a></li><li class="sidebar__navigation-link"><a class="sidebar__link" href="#resumen">Resumen</a></li></ul></nav></div><div class="sidebar__section"><nav class="sidebar__navigation"><ul class="sidebar__navigation-links"><li class="sidebar__navigation-link"><a class="sidebar__link" href="#tasks">Tareas (1)</a></li><li class="sidebar__navigation-link"><a class="sidebar__link" href="#comments">Comentarios</a></li></ul></nav></div><div class="sidebar__section"><div class="sidebar__section-title">Compartir</div><a class="share share_tw sidebar__share" href="https://twitter.com/share?url=https%3A%2F%2Fes.javascript.info%2Ffetch-crossorigin" rel="nofollow"></a><a class="share share_fb sidebar__share" href="https://www.facebook.com/sharer/sharer.php?s=100&amp;p[url]=https%3A%2F%2Fes.javascript.info%2Ffetch-crossorigin" rel="nofollow"></a></div><div class="sidebar__section"><a class="sidebar__link" href="https://github.com/javascript-tutorial/es.javascript.info/blob/master/5-network/05-fetch-crossorigin" rel="nofollow">Editar en GitHub</a></div></div></div></div></div></div><div class="page-footer"><ul class="page-footer__list"><li class="page-footer__item page-footer__item_copy">©&nbsp;2007—2023&nbsp; Ilya Kantor</li><li class="page-footer__item page-footer__item_about"><a class="page-footer__link" href="about.html">acerca del proyecto</a></li><li class="page-footer__item page-footer__item_contact"><a class="page-footer__link" href="about.html#contact-us">contáctenos</a></li></ul></div></body>
<!-- Mirrored from es.javascript.info/fetch-crossorigin by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 07 Feb 2023 21:14:43 GMT -->
</html>